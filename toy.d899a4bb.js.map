{"version":3,"sources":["src/vec2.js","src/toy.js"],"names":["Vec2","x","y","module","exports","require","constant","Object","ball","i","id","dx","dy","fx","fy","hit","size","Math","random","mass","spawn_balls","n","sim","list","push","canvas","width","height","apply_force_pair","ball_a","ball_b","dist","sqrt","penet","elastic","apply_wall_force","apply_mouse_force","mouse_x","mouse_y","update_vel_reset_force","time","friction","gravity","paused","initial_balls","run","document","getElementById","context","getContext","window","innerWidth","innerHeight","Array","update","length","o","clearRect","fillStyle","beginPath","arc","PI","closePath","fill","stroke","addEventListener","e","clientX","offsetLeft","clientY","offsetTop","keyCode","setInterval"],"mappings":"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","file":"toy.d899a4bb.js","sourceRoot":"..","sourcesContent":["\nclass Vec2 {\n    constructor(x, y) {\n        this.x = x\n        this.y = y\n    }\n}\n\nmodule.exports = Vec2;\n","\r\n// This does not do anything, other than prove\r\n// the build process is working.\r\nconst Vec2 = require('./vec2');\r\n(new Vec2(1, 0));\r\n\r\nvar constant = new Object()\r\nconstant.friction = 1.02\r\nconstant.elastic = 2000\r\nconstant.gravity = 0\r\nconstant.time = 0.01\r\nconstant.paused = false\r\n\r\ninitial_balls = 100\r\n\r\nfunction ball(i, x, y)\r\n{\r\n    this.id = i\r\n    this.x = x\r\n    this.y = y\r\n    this.dx = 0.0\r\n    this.dy = -10.0\r\n    this.fx = 0.0\r\n    this.fy = 0.0\r\n    this.hit = 0.0\r\n    this.size = 20 + Math.random() * 10\r\n    this.mass = (this.size*this.size*3.14)/10\r\n}\r\n\r\nfunction spawn_balls(n) {\r\n    for (i=0; i < n; i++)\r\n    {\r\n        sim.list.push(new ball(i, Math.random()*sim.canvas.width, Math.random()*sim.canvas.height))\r\n    }\r\n}\r\n\r\nfunction apply_force_pair(ball_a, ball_b) {\r\n    var dx = (ball_a.x-ball_b.x)\r\n    var dy = (ball_a.y-ball_b.y)\r\n    var dist = Math.sqrt(dx*dx + dy*dy)\r\n    var penet = ball_a.size+ball_b.size-dist\r\n    if (penet > 0)\r\n    {\r\n        if (ball_a.hit < 225) {ball_a.hit += 30}\r\n        else {ball_a.hit = 255}\r\n        if (ball_b.hit < 255){ball_b.hit += 30}\r\n        else {ball_b.hit = 255}\r\n        ball_a.fx += dx*penet/dist*constant.elastic\r\n        ball_b.fx -= dx*penet/dist*constant.elastic\r\n        ball_a.fy += dy*penet/dist*constant.elastic\r\n        ball_b.fy -= dy*penet/dist*constant.elastic \r\n    }\r\n}\r\n\r\nfunction apply_wall_force(ball) {\r\n    // collision with the walls\r\n    if (ball.x - ball.size < 0)                 {ball.fx -= (ball.x - ball.size)*constant.elastic}\r\n    if (ball.x + ball.size > sim.canvas.width)  {ball.fx -= (ball.x +ball.size - sim.canvas.width)*constant.elastic}\r\n    if (ball.y - ball.size < 0)                 {ball.fy -= (ball.y - ball.size)*constant.elastic}\r\n    if (ball.y + ball.size > sim.canvas.height) {ball.fy -= (ball.y + ball.size - sim.canvas.height)*constant.elastic}\r\n}\r\n\r\nfunction apply_mouse_force(ball) {\r\n    var dx = (ball.x-sim.mouse_x)\r\n    var dy = (ball.y-sim.mouse_y)\r\n    var dist = Math.sqrt(dx*dx + dy*dy)\r\n    var penet = 100-dist\r\n    if (penet > 0)\r\n    {\r\n        ball.fx += dx*penet/dist*constant.elastic     // add a suck variable with -1 or +1 value\r\n        ball.fy += dy*penet/dist*constant.elastic\r\n    }\r\n}\r\n\r\nfunction update_vel_reset_force(ball) {\r\n    ball.dx += ball.fx/ball.mass*constant.time\r\n    ball.dy += ball.fy/ball.mass*constant.time\r\n    ball.dx = ball.dx/constant.friction\r\n    ball.dy = ball.dy/constant.friction\r\n    ball.x += ball.dx\r\n    ball.y += ball.dy\r\n    ball.fy = constant.gravity*ball.mass\r\n    ball.fx = 0.0\r\n}\r\n\r\nsim = new Object()\r\nsim.run = function () \r\n{\r\n    if (constant.paused == true) {return}\r\n    sim.canvas = document.getElementById(\"balls_canvas\")\r\n    sim.context = sim.canvas.getContext(\"2d\")\r\n    sim.canvas.width = window.innerWidth\r\n    sim.canvas.height = window.innerHeight\r\n    sim.list = new Array\r\n    spawn_balls(initial_balls)\r\n    sim.update = function ()\r\n    {\r\n        for (i = 0; i < sim.list.length; i++)\r\n        {\r\n            // collision with another ball\r\n            for (o = i+1; o < sim.list.length; o++)\r\n            {\r\n                apply_force_pair(sim.list[i], sim.list[o])                    \r\n            }\r\n\r\n            apply_wall_force(sim.list[i])\r\n            apply_mouse_force(sim.list[i])\r\n        }\r\n\r\n        \r\n        // apply forces and clear them\r\n        for (i in sim.list)\r\n        {\r\n            update_vel_reset_force(sim.list[i])\r\n        }\r\n        \r\n        // clear screen\r\n        sim.context.clearRect(0,0,sim.canvas.width,sim.canvas.height) \r\n\r\n        // render balls\r\n        for (i in sim.list)\r\n        {\r\n            sim.context.fillStyle = \"rgb(0,0,\"+sim.list[i].hit+\")\"\r\n            sim.context.beginPath()\r\n            sim.context.arc(sim.list[i].x,sim.list[i].y,sim.list[i].size,0,Math.PI*2,true)\r\n            sim.context.closePath()\r\n            sim.context.fill()\r\n            sim.context.stroke()\r\n            \r\n            if (sim.list[i].hit > 10){sim.list[i].hit -= 10}\r\n            \r\n        }\r\n    }\r\n    sim.canvas.addEventListener(\"mousemove\", \r\n                        function(e) {\r\n                                        sim.mouse_x = (e.clientX-this.offsetLeft)\r\n                                        sim.mouse_y = (e.clientY-this.offsetTop) \r\n                                    }, false)\r\n    sim.canvas.addEventListener(\"click\", function(e) {sim.list.push(new ball(sim.list.length-1, sim.mouse_x, sim.mouse_y+40))}, false)\r\n    window.addEventListener(\"resize\",function(e) {\r\n                            sim.canvas.width = window.innerWidth;\r\n                            sim.canvas.height = window.innerHeight\r\n                        },false)\r\n    window.addEventListener(\"keydown\", function(e) {if (e.keyCode == 32) constant.paused = !constant.paused})\r\n    \t\t\t    \r\n    setInterval(sim.update, 1000/100)\r\n}"]}